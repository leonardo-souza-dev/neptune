@typeparam T
@inherits InputNumber<T>

<input @attributes="AdditionalAttributes" type="number" class="@CssClass" value="@valorString" @oninput="Entrar" @onblur="Sair" />

@code {
    private string valorString;
    private T ultimoValorConvertido;

    protected override void OnParametersSet()
    {
        if (!Equals(CurrentValue, ultimoValorConvertido))
        {
            ultimoValorConvertido = CurrentValue;
            valorString = CurrentValueAsString;
        }
    }

    private void Entrar(ChangeEventArgs e)
    {
        CurrentValueAsString = valorString = (string)e.Value;
        ultimoValorConvertido = CurrentValue;
    }

    private void Sair(FocusEventArgs e)
    {
        if (!EditContext.GetValidationMessages(FieldIdentifier).Any())
        {
            valorString = CurrentValueAsString;
        }
    }
}